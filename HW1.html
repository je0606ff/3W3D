<!DOCTYPE html>
<html>
<head><script type="text/javascript" src="/D65DD16339AE4F92BBACB44ACF3E3D71/C83CB8F3-35D6-ED49-A968-53C3BC6330C7/main.js" charset="UTF-8"></script>
<style>
	body {
		background-color: #fff;
		color: #111;
		margin: 0px;
		overflow: hidden;
		font-family: Monospace;
		font-size: 20px;
		position: absolute;
	}
	#info {
		position: absolute;
		top: 0px; width: 100%;
		
		padding: 5px;
		text-align: center;
		color: #ffff00;
	}
	#angleInfo {
		position: absolute;
		bottom: 100px; width: 100%;
		color: #ffffff;
		text-align: center;
	}
	strong {color: red}
</style>
</head>

<body>
<div id="info">
     press z for -- Earth_revolution/rotation and Moon_revolution/rotation<br/>
	 press x for ++ Earth_revolution/rotation and Moon_revolution/rotation<br/>
</div>
<audio id="soundtrack">
<source src="sounds/Phantom of the Opera- Lindsey Stirling.mp3" type='audio/mp3'>
</audio>
<script src="js/r69/three.min.js"></script>
<script src="js/OrbitControls.js"></script>
<script src="js/KeyboardState.js"></script>

<script>

var scene, renderer, camera;
var angle = 0;
var clock = new THREE.Clock();
var keyboard = new KeyboardState();
var controls;
var Sun, Earth, Moon;
var rotation = 6;
var soundtrack;
init();
animate();

function init()
{
	//Renderer
	renderer = new THREE.WebGLRenderer( {antialias:true} );
	var width = window.innerWidth;
	var height = window.innerHeight;
	renderer.setSize (width, height);
	renderer.setClearColor (0x888888);
	
	document.body.appendChild (renderer.domElement);
	//sound
	soundtrack = document.getElementById ('soundtrack');
	soundtrack.play();
	scene = new THREE.Scene();
	//Camera
	camera = new THREE.PerspectiveCamera (45, width/height, 1, 10000);
	camera.position.y = 100;
	camera.position.z = 250;
	camera.lookAt (new THREE.Vector3(0,0,0));
	
	controls = new THREE.OrbitControls (camera, renderer.domElement);
	
	// FLOOR
	var floorTexture = new THREE.ImageUtils.loadTexture( 'images/44630529.jpg' );
	floorTexture.wrapS = floorTexture.wrapT = THREE.RepeatWrapping; 
	var floorMaterial = new THREE.MeshBasicMaterial( { map: floorTexture, side: THREE.DoubleSide } );
	var floorGeometry = new THREE.PlaneGeometry(300, 300);//, 10, 10);  // not clear what segment does
	var floor = new THREE.Mesh(floorGeometry, floorMaterial);
	floor.position.y = -0.5;
	floor.rotation.x = Math.PI / 2;
	//scene.add(floor);
	
	//Sun 695500KM
	var SunGeom =  new THREE.SphereGeometry( 50, 32, 16 );
	var SunTexture = new THREE.ImageUtils.loadTexture( 'images/SunTexture.png' );
	var SunMaterial = new THREE.MeshBasicMaterial( { map : SunTexture, color: 0xffffff, wireframe: false, transparent: true } ); 
	Sun = new THREE.Mesh( SunGeom.clone(), SunMaterial );
	scene.add( Sun );
	
	//Earth 6378
	var EarthGeom =  new THREE.SphereGeometry( 10, 32, 16 );
	var EarthTexture = new THREE.ImageUtils.loadTexture( 'images/EarthTexture.png' );
	var EarthMaterial = new THREE.MeshBasicMaterial( { map : EarthTexture, color: 0xffffff, wireframe: false, transparent: true } ); 
	Earth = new THREE.Mesh( EarthGeom, EarthMaterial );
	Sun.add( Earth );
	
	//Moon 1738
	var MoonGeom =  new THREE.SphereGeometry( 5, 32, 16 );
	var MoonTexture = new THREE.ImageUtils.loadTexture( 'images/MoonTexture.png' );
	var MoonMaterial = new THREE.MeshBasicMaterial( { map : MoonTexture, color: 0xffffff, wireframe: false, transparent: true } ); 
	Moon = new THREE.Mesh( MoonGeom.clone(), MoonMaterial );
	Earth.add( Moon );
	
	//Grid
	var gridXZ = new THREE.GridHelper(150, 10);
	gridXZ.setColors( new THREE.Color(0xff0000), new THREE.Color(0xffffff) );
	scene.add(gridXZ);
	
	//PointLight
	var pointLight = new THREE.PointLight (0xffffff);
	pointLight.position.set (0,300,200);
	scene.add (pointLight);
	
	window.addEventListener ('resize', onWindowResize, false);
}

function onWindowResize ()
{
	camera.aspect = window.innerWidth / window.innerHeight;
	camera.updateProjectionMatrix();
	renderer.setSize (window.innerWidth, window.innerHeight);
}

function animate()
{
	controls.update();
	requestAnimationFrame ( animate );  
	render();
	update();
}

function render()
{	
	angle += rotation*clock.getDelta()/180*3.1416;
	Earth.position.set( 100*Math.cos(angle), 0, -100*Math.sin(angle));
	Earth.rotation.y = angle;
	
	Moon.position.set( 30*Math.cos(angle*12), 0, -30*Math.sin(angle*12));
	Moon.rotation.y = angle;
	//console.log(Earth.position.x, Earth.position.y, Earth.position.z);
	renderer.render (scene, camera);
}

function update()
{
	//controls.update();
	keyboard.update();         // this is required; this is a different keyboard callback
	if (rotation == 0 ){
		rotation += 1;
	}
	
	if (keyboard.down("Z") || keyboard.down("Z"))
		rotation--;
	if (keyboard.down("x") || keyboard.down("X"))
		rotation++;
		console.log(rotation);
}
</script>
</body>

</html>