<!DOCTYPE html>
<html>
<head><script type="text/javascript" src="/D65DD16339AE4F92BBACB44ACF3E3D71/C83CB8F3-35D6-ED49-A968-53C3BC6330C7/main.js" charset="UTF-8"></script>
<style>
	body {
		background-color: #fff;
		color: #111;
		margin: 0px; 
		overflow: hidden;
		font-family: Monospace;
		position: absolute;
		font-size: 40px;
	}
	#info {
		position: absolute;
		top: 0px; width: 100%;
		padding: 5px;
		text-align: left;
		color: #000000
	}
	a {color: yellow}
	strong {color:red}
</style>
</head>

<body>

<div id = "info"> 
	 <a href="javascript:OP();">open/close the door</a>
</div>



<script src="js/r69/three.min.js"></script>
<script src="js/OrbitControls.js"></script>
<script src="js/KeyboardState.js"></script>
</script>

<script>

var scene, renderer, camera;
var fram;
var controls;
var keyboard = new KeyboardState();
var column_1,column_2;
var platform_1,platform_2;
var door,door_handle,door_key;
var pivot_1,pivot_2;
var open = false;
init();
animate();

function init()
{
	renderer = new THREE.WebGLRenderer( {antialias:true} );
	var width = window.innerWidth;
	var height = window.innerHeight;
	renderer.setSize (width, height);
	renderer.setClearColor (0x888888);
	
	document.body.appendChild (renderer.domElement);

	scene = new THREE.Scene();
	//camera 
	camera = new THREE.PerspectiveCamera (45, width/height, 1, 10000);
	camera.position.y = 100;
	camera.position.z = 190;
	camera.lookAt (new THREE.Vector3(0,0,0));
	
	//controls 
	controls = new THREE.OrbitControls (camera, renderer.domElement);
	
	//fram
	frame = new THREE.Object3D();
    scene.add(frame);
	
	var texture = THREE.ImageUtils.loadTexture('images/WoodTexture.jpg');
    var bumptex = THREE.ImageUtils.loadTexture('images/WoodTexture_bump.jpg');
	
	
	
	var columnGeom = new THREE.BoxGeometry(5, 80, 5);
	var column_material = new THREE.MeshPhongMaterial({
		map: texture,
        color: 0xf6c4df,
        bumpMap: bumptex,
        bumpScale: 0.8,
        side: THREE.DoubleSide
	});
	column_1 = new THREE.Mesh(columnGeom, column_material);
	column_1.position.set(2.5,40,-2.5);
	column_2 = new THREE.Mesh(columnGeom, column_material);
	column_2.position.set(37.5,40,-2.5);
	
	var platformGeom = new THREE.BoxGeometry(30, 5, 5);
	var platform_material = new THREE.MeshPhongMaterial({
		map: texture,
        color: 0xf6c4df,
        bumpMap: bumptex,
        bumpScale: 0.8,
        side: THREE.DoubleSide
	});
	platform_1 = new THREE.Mesh(platformGeom, platform_material);
	platform_1.position.set(20,2.5,-2.5);
	platform_2 = new THREE.Mesh(platformGeom, platform_material);
	platform_2.position.set(20,77.5,-2.5);
	
	var pivot_1_Geom = new THREE.CylinderGeometry(1,1,5,32);
	var pivot_1_material = new THREE.MeshPhongMaterial({
        color: 0x888888,
	});
	pivot_1 = new THREE.Mesh(pivot_1_Geom, pivot_1_material);
	pivot_1.position.set(35,60,0);
	scene.add(pivot_1);
	frame.add(pivot_1);
	
	var pivot_2_Geom = new THREE.CylinderGeometry(1,1,5,32);
	var pivot_2_material = new THREE.MeshPhongMaterial({
        color: 0x888888,
	});
	pivot_2 = new THREE.Mesh(pivot_2_Geom, pivot_2_material);
	pivot_2.translateOnAxis (new THREE.Vector3(0,1,0), -35);
	pivot_1.add(pivot_2);
	
	var doorGeom = new THREE.BoxGeometry(30, 70, 5);
	var door_material = new THREE.MeshPhongMaterial({
		map: texture,
        color: 0xf6c4df,
        bumpMap: bumptex,
        bumpScale: 0.8,
        side: THREE.DoubleSide
	});
	door = new THREE.Mesh(doorGeom, door_material);
	door.translateOnAxis (new THREE.Vector3(0,0,1), -2.5);
	door.translateOnAxis (new THREE.Vector3(0,1,0), -20);
	door.translateOnAxis (new THREE.Vector3(1,0,0), -15);
	pivot_1.add(door);
	
	var door_handle_Geom = new THREE.CylinderGeometry(1,1,3,32);
	var door_handle_material = new THREE.MeshLambertMaterial({color: 0x888888, wireframe:false});
	door_handle = new THREE.Mesh(door_handle_Geom, door_handle_material);
	door_handle.translateOnAxis (new THREE.Vector3(1,0,0), -25);
	door_handle.translateOnAxis (new THREE.Vector3(0,1,0), -20);
	door_handle.rotation.x = Math.PI/2;
	pivot_1.add(door_handle);
	
	var door_key_Geom = new THREE.SphereGeometry(2,32,16);
	var door_key_material = new THREE.MeshLambertMaterial({color: 0xd0f0dd, wireframe:false});
	door_key = new THREE.Mesh(door_key_Geom, door_key_material);
	door_key.translateOnAxis (new THREE.Vector3(1,0,0), -25);
	door_key.translateOnAxis (new THREE.Vector3(0,1,0), -20);
	door_key.translateOnAxis (new THREE.Vector3(0,0,1), 3);
	pivot_1.add(door_key);
	
	scene.add(column_1);
	scene.add(column_2);
	scene.add(platform_1);
	scene.add(platform_2);
	
	
	var gridXZ = new THREE.GridHelper(100, 10);
	gridXZ.setColors( new THREE.Color(0xff0000), new THREE.Color(0xffffff) );
	scene.add(gridXZ);

	var pointLight = new THREE.PointLight (0xffffff);
	pointLight.position.set (0,300,300);
	scene.add (pointLight);
	
	window.addEventListener ('resize', onWindowResize, false);
}

function onWindowResize ()
{
	camera.aspect = window.innerWidth / window.innerHeight;
	camera.updateProjectionMatrix();
	renderer.setSize (window.innerWidth, window.innerHeight);
}

function animate()
{
	controls.update();
	requestAnimationFrame ( animate );  
	render();
}

function render()
{	
	if (open){
		if (pivot_1.rotation.y > 2.5)
			pivot_1.rotation.y == 2.5;
		else
			pivot_1.rotation.y += 0.05;
	}
	else{
		if (pivot_1.rotation.y < 0 || pivot_1.rotation.y == 0)
			pivot_1.rotation.y == 0;
		else
			pivot_1.rotation.y -= 0.05;
	}
	//console.log(pivot_1.rotation.y);
	renderer.render(scene, camera);
}

function OP()
{
	open = !open;
	console.log(open);
}
</script>
</body>

</html>